# CSUAutoSelect

中南大学自动选课工具 V3.0

原作者：[@DavidHuang](https://github.com/CrazyDaveHDY)

## 新版本特性

- 🚀 **异步并发**：使用异步IO，提供更好的性能和并发能力
- 🏗️ **模块化设计**：面向对象架构，代码更清晰易维护
- ⚙️ **配置管理**：独立的配置管理器，支持更灵活的配置
- 🛡️ **错误处理**：统一的异常处理机制
- 📝 **类型提示**：完整的类型注解，提高代码可读性
- 🔧 **易于扩展**：简洁的类设计，便于添加新功能

## 安装

### 环境要求
- Python 3.7+
- 网络连接

### 安装依赖

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install httpx
```

### 获取代码

```bash
git clone https://github.com/Ruinwalker7/CSUAutoSelect.git
cd CSUAutoSelect
```

## 配置

1. 复制配置文件模板：
```bash
cp config_template.ini config.ini
```

2. 编辑 `config.ini` 文件，填入你的信息：
   - `username`: 你的学号
   - `password`: 你的教务系统密码
   - `time`: 学期（格式：2024-2025-1）
   - `num1`: 公选课数量
   - `id1`, `id2`, ...: 公选课ID
   - `num2`: 必修课数量
   - `id_1`, `id_2`, ...: 必修课ID

## 运行

```bash
python autoselect.py
```

程序会自动使用异步模式运行，提供最佳的并发性能。

## 如何获取课程ID

### 方法一：从选课页面获取
1. 登录教务系统
2. 进入选课页面
3. 找到想要选择的课程
4. 右键点击"选课"按钮，选择"检查元素"
5. 在HTML代码中找到包含 `jx0404id` 的链接
6. 复制 `jx0404id` 参数的值

### 方法二：从课表查询页面获取
1. 访问 [中南大学教务系统课表查询页面](http://csujwc.its.csu.edu.cn/jiaowu/pkgl/llsykb/llsykb_find_jg0101.jsp)
2. 点击「按教师」按钮
3. 输入学年学期、教师名称后点击「查询」
4. 格子中央的6位数字编号即为课程ID

## 程序结构

```
CSUAutoSelect/
├── autoselect.py          # 主程序文件
├── config.ini            # 配置文件（需要创建）
├── config_template.ini   # 配置模板
├── requirements.txt      # 依赖列表
├── README.md            # 说明文档
└── assets/              # 资源文件
```

### 核心类说明

- `ConfigManager`: 配置管理器，负责读取和解析配置文件
- `CourseSelector`: 选课器，使用异步并发进行选课
- `CourseConfig`: 课程配置数据类
- `LoginConfig`: 登录配置数据类

## 使用示例

### 配置文件示例
```ini
[config]
username = 2020123456
password = your_password
time = 2024-2025-1
num1 = 2
id1 = 123456
id2 = 789012
num2 = 1
id_1 = 345678
```

### 运行流程
1. 程序启动，读取配置文件
2. 获取验证码图片（保存为 code.jpg）
3. 用户输入验证码
4. 登录教务系统
5. 进入选课页面
6. 开始异步并发抢课
7. 显示抢课结果

## 注意事项

- ⚠️ **请确保网络稳定**：选课过程中需要保持网络连接
- ⚠️ **验证码识别**：需要人工识别验证码，程序无法自动识别
- ⚠️ **课程冲突**：注意所选课程之间是否存在时间冲突
- ⚠️ **选课时间**：确保在选课开放时间内运行程序
- ⚠️ **账号安全**：密码仅保存在本地，不会上传到任何服务器

## 故障排除

### 常见问题

1. **登录失败**
   - 检查学号和密码是否正确
   - 确认验证码输入正确
   - 检查网络连接

2. **找不到课程**
   - 确认课程ID是否正确
   - 检查学期设置是否正确
   - 确认课程是否在当前选课阶段开放

3. **程序异常退出**
   - 检查配置文件格式是否正确
   - 确认所有必需的配置项都已填写
   - 查看错误信息，根据提示修复

## 声明

- 本程序仅用于学习和研究目的
- 使用本程序产生的任何后果由用户自行承担
- 请遵守学校相关规定，合理使用选课系统
- 程序不会对服务器造成过大负担，采用合理的请求频率

## 许可协议

本项目采用 [GPL-3.0 License](LICENSE) 开源协议。

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目！

## 更新日志

### V3.0
- 重构代码结构，采用面向对象设计
- 使用异步IO，提升性能和并发能力
- 改进错误处理机制
- 优化配置管理
- 添加类型提示
- 简化程序结构，只保留异步模式

### V2.0
- 支持验证码输入
- 支持多课程同时抢课
- 改进用户界面

